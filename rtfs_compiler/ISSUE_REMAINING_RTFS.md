Title: RTFS: Remaining parser, stdlib and runtime work (tracked tasks)

Summary
-------
After applying parser fixes (broadened string escape handling and added a braced map-type form) and several runtime/stdlib patches, the RTFS end-to-end feature test suite still has failing features. This file lists failing features, representative errors, and recommended next work items so they can be tracked as an issue or split into smaller issues.

Test run summary
----------------
- Command: cargo test --test e2e_features -- --nocapture --test-threads 1
- Total feature groups: 14
- Passed: 2 (let_expressions, if_expressions)
- Failed: 12
- Current failing feature groups and representative errors:
  - function_expressions: Generic("Not a function: nil") (IR)
  - do_expressions: UndefinedSymbol(Symbol("i")) (AST)
  - match_expressions: IR conversion error: UndefinedSymbol { symbol: "x" }
  - try_catch_expressions: DivisionByZero (IR)
  - def_defn_expressions: UndefinedSymbol(Symbol("a")) (AST)
  - parallel_expressions: DivisionByZero (IR)
  - with_resource_expressions: IoError("No such file or directory (os error 2)") (AST)
  - literal_values: Parse error for string containing many punctuation characters (escape_sequence)
  - vector_operations: UndefinedSymbol(Symbol("sort")) (AST)
  - map_operations: ArityMismatch { function: "update", expected: "3", actual: 4 } (AST)
  - rtfs2_special_forms: Generic("FATAL: Host method called without a valid execution context") (AST)
  - type_system: Parse error: map_type expected bracketed entries but found braced form in some cases (map_type_entry_braced not accepted everywhere)

What I changed so far
---------------------
- Parser (`rtfs_compiler/src/rtfs.pest`):
  - Broadened `escape_sequence` to accept any escaped non-newline character.
  - Added `map_type_entry_braced` and allowed it in `map_type` so compact braced map-type syntax parses.
- Runtime / stdlib (already applied in earlier edits):
  - Implemented `keys`, `vals`, `update` (minimal) in stdlib and registered metadata in IR conversion.
  - Added AST `set!` handler (conservative implementation).
  - Implemented IR runtime support for BuiltinWithContext `update` and a few IR node handlers (Program/VariableBinding/Param).
  - Added a missing test fixture for with-resource tests.

Recommended next tasks (actionable)
-----------------------------------
1. Implement missing stdlib helpers referenced by tests (examples: `sort`, `sort-by`, `frequencies`) and register IR metadata.
2. Update `update` semantics/arity to accept the 4-arg form used in tests (map key + default? + updater + extra arg) — confirm exact signature and tests.
3. Investigate and fix undefined-symbol failures in AST/IR (e.g., `i`, `a`, `x`) — likely scoping or converter issues.
4. Ensure host execution context is correctly initialized or guarded (fix "Host method called without a valid execution context" errors).
5. Replace placeholder `set!` lowering with a proper IR assign node and runtime semantics.
6. Add unit tests for stdlib helpers and IR runtime paths used by those helpers.
7. Re-run e2e feature tests and iterate on failing cases.

Notes & pointers
----------------
- Parser grammar: rtfs_compiler/src/rtfs.pest
- AST evaluator: rtfs_compiler/src/runtime/evaluator.rs
- Stdlib: rtfs_compiler/src/runtime/stdlib.rs
- IR converter: rtfs_compiler/src/ir/converter.rs
- IR runtime: rtfs_compiler/src/runtime/ir_runtime.rs
- Test harness: tests/e2e_features.rs and tests/rtfs_files/features/

How to proceed
---------------
I recommend splitting the work into 2 PRs: (A) parser fixes and small runtime adjustments (already applied parser fixes), and (B) stdlib + IR runtime helpers + assign semantics. If you'd like, I can start implementing the stdlib helpers and the `update`-arity fix next.

-- Auto-generated by GitHub Copilot bot changes
