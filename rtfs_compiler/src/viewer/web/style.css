html, body {
    height: 100%;
}

body {
    display: flex;
    flex-direction: column;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background-color: #1a1a1a;
    color: #f0f0f0;
    margin: 0;
    padding: 0; /* page padding removed; main container should manage spacing */
}

h1, h2, h3 {
    color: #00aaff;
    border-bottom: 1px solid #444;
    padding-bottom: 5px;
    margin-top: 0;
}

/* Goal Input Section */
#goal-section {
    background-color: #252525;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
}

#goal-form {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

#goal-input {
    flex: 1;
    padding: 10px;
    background-color: #333;
    border: 1px solid #555;
    border-radius: 4px;
    color: #f0f0f0;
    font-size: 16px;
}

#goal-input:focus {
    outline: none;
    border-color: #00aaff;
}

#goal-input.valid {
    border-color: #00aa00;
    background-color: rgba(0, 170, 0, 0.05);
}

#goal-input.invalid {
    border-color: #aa0000;
    background-color: rgba(170, 0, 0, 0.05);
}

#generate-graph-btn {
    padding: 10px 20px;
    background-color: #00aaff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
}

#generate-graph-btn:hover {
    background-color: #0088cc;
}

#goal-status {
    color: #888;
    font-size: 12px;
    margin-left: 16px;
    font-style: italic;
}

/* Action Buttons */
#action-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

#action-buttons button {
    padding: 8px 16px;
    background-color: #333;
    color: #f0f0f0;
    border: 1px solid #555;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
}

#action-buttons button:hover:not(:disabled) {
    background-color: #444;
}

#action-buttons button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Graph Controls */
#graph-controls {
    display: flex;
    gap: 5px;
    margin-left: auto;
}

#graph-controls button {
    padding: 6px 10px;
    font-size: 14px;
    min-width: 35px;
    background-color: #555;
    border: 1px solid #777;
    border-radius: 4px;
    color: #f0f0f0;
    cursor: pointer;
    transition: all 0.2s ease;
}

#graph-controls button:hover:not(:disabled) {
    background-color: #666;
    transform: scale(1.05);
}

#graph-controls button:active {
    transform: scale(0.95);
}

#toggle-physics-btn.active {
    background-color: #00aa00;
    border-color: #00ff00;
}

/* Save/Load Controls */
#save-load-controls {
    display: flex;
    gap: 5px;
    margin-left: auto;
}

#save-load-controls button {
    padding: 6px 10px;
    font-size: 14px;
    background-color: #444;
    border: 1px solid #666;
    border-radius: 4px;
    color: #f0f0f0;
    cursor: pointer;
    transition: all 0.2s ease;
}

/* Graph History Controls */
#graph-history-controls {
    display: flex;
    gap: 5px;
    margin-left: auto;
    align-items: center;
}

#graph-history-selector {
    padding: 6px 10px;
    font-size: 14px;
    background-color: #333;
    border: 1px solid #666;
    border-radius: 4px;
    color: #f0f0f0;
    min-width: 200px;
    cursor: pointer;
}

#graph-history-selector:focus {
    outline: none;
    border-color: #00aaff;
    box-shadow: 0 0 5px rgba(0, 170, 255, 0.3);
}

#graph-history-selector option {
    background-color: #333;
    color: #f0f0f0;
}

#load-history-graph-btn,
#delete-history-graph-btn {
    padding: 6px 10px;
    font-size: 14px;
    background-color: #444;
    border: 1px solid #666;
    border-radius: 4px;
    color: #f0f0f0;
    cursor: pointer;
    transition: all 0.2s ease;
}

#load-history-graph-btn:hover:not(:disabled) {
    background-color: #00aa00;
    border-color: #00ff00;
}

#delete-history-graph-btn:hover:not(:disabled) {
    background-color: #aa0000;
    border-color: #ff0000;
}

#load-history-graph-btn:disabled,
#delete-history-graph-btn:disabled {
    background-color: #222;
    border-color: #444;
    color: #666;
    cursor: not-allowed;
}

#save-load-controls button:hover:not(:disabled) {
    background-color: #555;
    transform: scale(1.05);
}

#save-load-controls button:active {
    transform: scale(0.95);
}

#generate-plans-btn {
    background-color: #ffaa00;
    color: #000;
}

#generate-plans-btn:hover:not(:disabled) {
    background-color: #cc8800;
}

#execute-btn {
    background-color: #00aa00;
}

#execute-btn:hover:not(:disabled) {
    background-color: #008800;
}

#clear-btn {
    background-color: #aa0000;
}

#clear-btn:hover:not(:disabled) {
    background-color: #880000;
}

/* Main Container */
.container {
    display: flex;
    flex-direction: row;
    gap: 20px;
    /* Allow the container to grow and shrink with the viewport, avoid internal page scrolling */
    flex: 1 1 auto;
    min-height: 0; /* enables proper flexbox children shrinking */
    padding: 20px; /* keep spacing previously provided by body padding */
    box-sizing: border-box;
    overflow: hidden; /* prevent page-level vertical scrolling; child panes scroll internally */
}

.left-panel, .right-panel {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.left-panel {
    flex: 1;
}

.right-panel {
    flex: 1;
}

/* Graph Container */
#graph-container {
    flex: 2;
    border: 1px solid #444;
    border-radius: 8px;
    background-color: #252525;
    display: flex;
    flex-direction: column;
    min-height: 400px; /* Add minimum height for vis.js to render */
}

#graph-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #444;
    flex-wrap: wrap;
    gap: 10px;
}

#graph-controls-top {
    display: flex;
    align-items: center;
    gap: 5px;
    flex: 1;
    max-width: 300px;
}

#node-search {
    flex: 1;
    padding: 6px 10px;
    background-color: #333;
    border: 1px solid #555;
    border-radius: 4px;
    color: #f0f0f0;
    font-size: 13px;
}

#node-search:focus {
    outline: none;
    border-color: #00aaff;
}

#node-search::placeholder {
    color: #888;
}

#clear-search-btn {
    padding: 6px 8px;
    background-color: #555;
    border: 1px solid #777;
    border-radius: 4px;
    color: #f0f0f0;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

#clear-search-btn:hover {
    background-color: #666;
}

#graph-stats {
    font-size: 12px;
    color: #888;
    white-space: nowrap;
}

#graph-visualization {
    flex: 1;
    min-height: 300px;
    border-top: 1px solid #444;
}

/* Plan Details Panel Styling */
#plan-details-panel {
    background: #2a2a2a;
    border: 1px solid #00ff88;
    border-radius: 8px;
    margin-bottom: 15px;
    overflow: hidden;
    max-height: 300px;
    overflow-y: auto;
    position: relative;
    z-index: 10;
}

#plan-header {
    background: linear-gradient(135deg, #00ff88, #00cc66);
    color: #1a1a1a;
    padding: 12px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #00ff88;
}

#plan-header h3 {
    margin: 0;
    font-size: 16px;
    font-weight: bold;
}

#close-plan-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s ease;
}

#close-plan-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

#plan-content {
    padding: 15px;
}

#plan-preview {
    background: #1a1a1a;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 10px;
    margin-bottom: 10px;
    font-family: monospace;
    font-size: 12px;
    color: #00ff88;
    word-wrap: break-word;
}

#plan-code {
    background: #1a1a1a !important;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 15px !important;
    font-family: 'Fira Code', 'Monaco', 'Consolas', monospace !important;
    font-size: 13px !important;
    line-height: 1.4 !important;
    color: #ffffff !important;
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    max-height: 400px;
    overflow-y: auto;
}

/* Enhanced node styling for intents with plans */
.vis-network .vis-node.has_plan {
    border-color: #00ff88 !important;
    box-shadow: 0 0 15px rgba(0, 255, 136, 0.3) !important;
    border-width: 3px !important;
}

.vis-network .vis-node.has_plan .vis-node-label {
    color: #00ff88 !important;
    font-weight: bold !important;
}

/* Plan indicator badge on nodes */
.vis-network .vis-node.has_plan::after {
    content: "ðŸ“‹";
    position: absolute;
    top: -8px;
    right: -8px;
    background: #00ff88;
    color: #000;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    border: 2px solid #fff;
    z-index: 1000;
}

/* RTFS Container */
#rtfs-container {
    flex: 1;
    border: 1px solid #444;
    border-radius: 8px;
    background-color: #252525;
    display: flex;
    flex-direction: column;
    min-width: 0;
    max-width: 100% !important;
    overflow: hidden;
    width: 100% !important;
    box-sizing: border-box;
}

#rtfs-container h3 {
    margin: 10px;
}

#rtfs-container pre {
    flex: 1;
    overflow: auto;
    margin: 0;
    padding: 10px;
    width: 100% !important;
    min-width: 0;
    max-width: 100% !important;
    box-sizing: border-box;
}

/* Tabs */
#code-tabs {
    display: flex;
    gap: 6px;
    padding: 0 10px 10px 10px;
    align-items: center;
}

#code-tabs button {
    background: linear-gradient(180deg, #3a3a3a 0%, #2a2a2a 100%);
    border: 1px solid #555;
    color: #e6e6e6;
    border-radius: 6px;
    padding: 7px 14px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    letter-spacing: .25px;
    min-width: 70px;
    text-align: center;
    flex-shrink: 0;
    line-height: 1.1;
    position: relative;
    transition: background .15s ease, color .15s ease, border-color .15s ease, box-shadow .15s ease;
}
#code-tabs button:hover:not(.active) {
    background: linear-gradient(180deg, #4a4a4a 0%, #353535 100%);
    border-color: #666;
}
#code-tabs button:focus-visible {
    outline: 2px solid #00ccff;
    outline-offset: 2px;
}
#code-tabs button.active {
    background: linear-gradient(180deg, #00bbff 0%, #0095d4 100%);
    border-color: #00caff;
    color: #0b0b0b;
    box-shadow: 0 0 0 1px #003d4d inset, 0 0 4px rgba(0,200,255,0.4);
    font-weight:600;
}
#code-tabs button.active:hover {
    background: linear-gradient(180deg, #22c8ff 0%, #00a6e6 100%);
}

.tab-controls {
    margin-left: auto;
    display: flex;
    gap: 6px;
}

.format-toggle {
    background-color: #444;
    border: 1px solid #666;
    color: #f0f0f0;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

.format-toggle:hover {
    background-color: #555;
}

.format-toggle.rtfs-mode {
    background-color: #00aaff;
    border-color: #00aaff;
    color: #000;
}

.format-toggle.json-mode {
    background-color: #ffaa00;
    border-color: #ffaa00;
    color: #000;
}

.wrap-toggle {
    background-color: #444;
    border: 1px solid #666;
    color: #f0f0f0;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

.wrap-toggle:hover {
    background-color: #555;
}

.wrap-toggle.active {
    background-color: #00aa00;
    border-color: #00aa00;
    color: #000;
}

.copy-btn {
    background-color: #444;
    border: 1px solid #666;
    color: #f0f0f0;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

.copy-btn:hover {
    background-color: #555;
}

.copy-btn:active {
    background-color: #00aa00;
    border-color: #00aa00;
}

#code-panes {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-width: 0;
    max-width: 100% !important;
    overflow: hidden;
    width: 100% !important;
}

.code-pane {
    display: block;
    background-color: #1e1e1e;
    border: 1px solid #333;
    border-radius: 6px;
    color: #f0f0f0;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    line-height: 1.4;
    /* Allow the pane to flex and fill available space inside #code-panes */
    flex: 1 1 auto;
    min-height: 0; /* allow flex children to shrink properly */
    margin: 0;
    padding: 10px;
    white-space: pre-wrap;
    word-wrap: break-word;
    word-break: break-all;
    min-width: 0;
    max-width: 100% !important;
    width: 100% !important;
    box-sizing: border-box;
}

.code-pane.hidden {
    display: none;
}

.code-pane code {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-all !important;
    display: block;
    width: 100% !important;
    min-width: 0;
    max-width: 100% !important;
    box-sizing: border-box;
    overflow-wrap: anywhere;
    /* Make code fill the pane and scroll internally when content overflows */
    height: 100%;
    max-height: none;
    overflow: auto;
}

.code-pane pre {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-all !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box;
    /* Make pre elements fill the pane and scroll when content overflows */
    height: 100%;
    max-height: none;
    overflow: auto;
}

/* Intent Actions */
.action-btn {
    background-color: #333;
    border: 1px solid #555;
    color: #f0f0f0;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 12px;
    margin-right: 6px;
    transition: all 0.2s ease;
}

.action-btn:hover:not(:disabled) {
    background-color: #555;
    border-color: #777;
}

.action-btn:disabled {
    background-color: #222;
    border-color: #444;
    color: #666;
    cursor: not-allowed;
}

/* Log Container */
#log-container {
    /* Use flex so the log container can grow/shrink with its parent pane */
    flex: 1 1 auto;
    border: 1px solid #444;
    border-radius: 8px;
    background-color: #252525;
    display: flex;
    flex-direction: column;
    min-height: 0; /* enable proper flex shrink behavior */
}

/* Collapsed by default: show header row only */
#log-container:not(.logs-expanded) {
    flex: 0 0 auto;
    height: 40px;
    min-height: 40px;
    max-height: 40px;
    overflow: hidden;
}

/* Expanded: allow the container to fill available space and let entries scroll internally */
#log-container.logs-expanded {
    flex: 1 1 auto;
    height: auto; /* let flex sizing decide */
    min-height: 150px;
    max-height: none;
    overflow: hidden; /* header fixed, entries scroll */
    position: relative;
}

/* During dragging, disable flex behavior and allow manual height control */
#log-container.dragging {
    flex: none !important;
    flex-grow: 0 !important;
    flex-shrink: 0 !important;
    flex-basis: auto !important;
    max-height: none !important;
}

/* Resize handle removed: activity logs are toggle-only and not manually resizable */

/* Visual feedback during dragging */
#log-container.dragging {
    border: 2px solid #00ff88;
    box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
}

#log-container.dragging #log-resize-handle {
    background: linear-gradient(to right, #00ff88 0%, #00ffaa 50%, #00ff88 100%);
    height: 10px;
}

/* Make sure the header doesn't interfere with dragging */
#log-header {
    pointer-events: none;
}

#log-header * {
    pointer-events: auto;
}

/* Ensure logs are collapsed by default */
#log-entries {
    display: none;
}

/* Show logs when expanded */
#log-container.logs-expanded #log-entries {
    display: block;
    flex: 1 1 auto;
    min-height: 0;
}

#log-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #444;
}

#log-header h3 {
    margin: 0;
}

.log-controls {
    display: flex;
    gap: 8px;
    align-items: center;
}

#log-filter {
    padding: 4px 8px;
    background-color: #333;
    border: 1px solid #555;
    border-radius: 4px;
    color: #f0f0f0;
    font-size: 12px;
    cursor: pointer;
}

#log-filter:focus {
    outline: none;
    border-color: #00aaff;
}

#clear-logs,
#toggle-logs {
    background-color: #444;
    border: 1px solid #666;
    color: #f0f0f0;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s ease;
}

#clear-logs:hover,
#toggle-logs:hover {
    background-color: #555;
}

#toggle-logs.logs-expanded {
    background-color: #0066cc;
    border-color: #0088dd;
}

#toggle-logs.logs-collapsed {
    background-color: #444;
    border-color: #666;
}


#log-entries {
    flex: 1 1 auto;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 10px;
    font-family: "Fira Code", monospace;
    font-size: 0.9em;
    max-height: none; /* let parent control height */
    min-height: 0;
}

.log-entry {
    padding: 2px 0;
    border-bottom: 1px solid #333;
}

.log-entry:last-child {
    border-bottom: none;
}

/* Status indicators */
.status-pending { color: #ffff00; }
.status-active { color: #00aaff; }
.status-executing { color: #ffaa00; }
.status-completed { color: #00aa00; }
.status-failed { color: #aa0000; }
.status-paused { color: #ffaa00; }
.status-error { color: #aa0000; }

/* Intent status in details */
.status-pending,
.status-active,
.status-executing,
.status-completed,
.status-failed,
.status-paused,
.status-error {
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 0.9em;
    font-weight: bold;
}

.status-pending { background-color: rgba(255, 255, 0, 0.1); }
.status-active { background-color: rgba(0, 170, 255, 0.1); }
.status-executing { background-color: rgba(255, 170, 0, 0.1); }
.status-completed { background-color: rgba(0, 170, 0, 0.1); }
.status-failed { background-color: rgba(170, 0, 0, 0.1); }
.status-paused { background-color: rgba(255, 170, 0, 0.1); }
.status-error { background-color: rgba(170, 0, 0, 0.1); }

/* Connection Status */
#connection-status {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    margin-left: 8px;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.3s ease;
}

#connection-indicator {
    font-size: 12px;
    font-weight: bold;
}

.status-connected {
    background-color: rgba(0, 170, 0, 0.1);
    border: 1px solid #00aa00;
    color: #00aa00;
}

.status-connected #connection-indicator {
    color: #00aa00;
}

.status-disconnected {
    background-color: rgba(170, 0, 0, 0.1);
    border: 1px solid #aa0000;
    color: #aa0000;
}

.status-disconnected #connection-indicator {
    color: #aa0000;
}

.status-connecting {
    background-color: rgba(255, 170, 0, 0.1);
    border: 1px solid #ffaa00;
    color: #ffaa00;
}

.status-connecting #connection-indicator {
    color: #ffaa00;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* Status Bar */
#status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background-color: #2a2a2a;
    border: 1px solid #444;
    border-radius: 4px;
    margin-top: 10px;
    font-size: 12px;
    color: #ccc;
}

#status-left {
    display: flex;
    gap: 20px;
}

#status-right {
    display: flex;
    align-items: center;
}

#activity-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    border-radius: 4px;
    background-color: rgba(255, 170, 0, 0.1);
    border: 1px solid #ffaa00;
    color: #ffaa00;
    transition: all 0.3s ease;
}

.activity-hidden {
    display: none !important;
}

.activity-spinner {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Node Badges */
.node-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    font-size: 10px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid #fff;
    z-index: 10;
}

.badge-plan {
    background-color: #00aa00;
    color: white;
}

.badge-status {
    background-color: #00aaff;
    color: white;
}

.badge-status.pending {
    background-color: #ffff00;
    color: #000;
}

.badge-status.active {
    background-color: #00aaff;
    color: white;
}

.badge-status.executing {
    background-color: #ffaa00;
    color: #000;
}

.badge-status.completed {
    background-color: #00aa00;
    color: white;
}

.badge-status.failed {
    background-color: #aa0000;
    color: white;
}

/* Log Entry Styling */
.log-entry.info {
    color: #00aaff;
}

.log-entry.warning {
    color: #ffaa00;
}

.log-entry.error {
    color: #aa0000;
}

.log-entry.hidden {
    display: none;
}

/* Execution History (Exec tab) */
#exec-layout {
    display: flex;
    gap: 12px;
    height: 100%;
    min-height: 0;
}

#exec-runs-panel {
    width: 140px;
    min-width: 120px;
    border-right: 1px solid #333;
    overflow-y: auto;
}

.exec-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px 6px;
    border-bottom: 1px solid #333;
    background: #1f1f1f;
}

.exec-runs-list {
    list-style: none;
    margin: 0;
    padding: 0;
}

.exec-run-item {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 8px;
    border-bottom: 1px solid #222;
    cursor: pointer;
    font-size: 12px;
}

.exec-run-item:hover { background: #2a2a2a; }

.exec-run-id { font-family: monospace; color: #ccc; }
.exec-run-status { margin-left: auto; font-size: 1px; padding: 2px 4px; border-radius: 3px; text-transform: uppercase; }
.exec-status-running { background: #555; color: #fff; }
.exec-status-success { background: #056f05; color: #d3ffd3; }
.exec-status-partial { background: #8a6e00; color: #fff1bd; }
.exec-status-fail { background: #6f0505; color: #ffd3d3; }
.exec-run-time { color: #777; font-size: 10px; }

.exec-status-badge { padding: 6px 10px; border-radius: 4px; font-size: 12px; font-weight: 700; }
.exec-status-running { background: rgba(255,255,0,0.2); }
.exec-status-success { background: rgba(0,170,0,0.25); }
.exec-status-fail { background: rgba(170,0,0,0.25); }

/* Consolidated exec intents table rule (single authoritative definition) */
.exec-intents-table { width: 100%; border-collapse: collapse; font-size: 13px; }
.exec-intents-table th, .exec-intents-table td { border: 1px solid #333; padding: 6px; text-align: left; vertical-align: top; }
.exec-intents-table th { background: #1f1f1f; }
.exec-intents-table tbody tr:hover { background: #222; }

.err-cell { color: #ff6b6b; font-family: monospace; }

.exec-phase-badge { display: inline-block; padding: 3px 8px; margin-right: 6px; border-radius: 3px; font-size: 11px; font-weight: 700; letter-spacing: .5px; }
.phase-started { background: #004a7a; color: #8fd3ff; }
.phase-executing { background: #7a5e00; color: #ffe08f; }
.phase-completed { background: #005a1f; color: #8fffbe; }
.phase-failed { background: #5a0000; color: #ff9f9f; }
.phase-skipped { background: #404040; color: #cfcfcf; }

#exec-summary-json { background: #1a1a1a; border: 1px solid #333; padding: 8px; font-size: 11px; max-height: 150px; overflow: auto; }

.exec-log { background: #111; border: 1px solid #333; padding: 4px; font-family: "Fira Code", monospace; font-size: 10px; max-height: 140px; overflow-y: auto; }
.exec-log-entry { padding: 2px 3px; border-bottom: 1px solid #222; line-height: 1.15; display: flex; flex-wrap: wrap; gap: 3px; align-items: center; }
.exec-log-entry:last-child { border-bottom: none; }
.exec-log-time { color: #666; font-size: 10px; }
.exec-log-icon { width: 18px; text-align: center; }
.exec-intent-id { font-family: monospace; background: #2a2a2a; padding: 2px 4px; border-radius: 3px; color: #ccc; }
.exec-log-message { color: #ddd; }
.exec-error { color: #ff5555; font-weight: 600; }
.exec-result { background: #004a1f; color: #8fffbe; padding: 2px 4px; border-radius: 3px; font-size: 10px; }
.exec-summary-inline { background: #000; border: 1px solid #222; padding: 6px; margin: 6px 0 0 0; width: 100%; white-space: pre-wrap; }
.exec-type-start { background: rgba(0,170,255,0.05); }
.exec-type-finish { background: rgba(0,170,0,0.05); }
.exec-type-summary { background: rgba(255,170,0,0.05); }
.exec-type-intent-phase.has-error { background: rgba(170,0,0,0.08); }

/* --- Compact Execution UI Enhancements (hybrid) ---
   Consolidated and increased font sizes for better readability. */
.exec-run-stats { display:flex; gap:8px; flex-wrap:wrap; margin:6px 0 6px; font-size:14px; }
.exec-stat-chip { background:#222; padding:6px 10px; border-radius:10px; line-height:1.15; display:inline-flex; align-items:center; gap:8px; font-size:14px; }
.exec-stat-chip.success { background:#0a3; color:#d2ffd2; }
.exec-stat-chip.fail { background:#600; color:#ffd2d2; }
.exec-stat-chip.skipped { background:#444; color:#ccc; }
.intent-timeline { display:flex; gap:8px; overflow-x:auto; padding:4px 2px 6px; border-bottom:1px solid #222; margin-bottom:6px; }
.intent-chip { min-width:72px; background:#1d1d1d; padding:8px 10px; border-radius:4px; cursor:pointer; font-size:13px; position:relative; border:1px solid #2a2a2a; }
.intent-chip.running { border-color:#888; }
.intent-chip.success { border-color:#0a3; }
.intent-chip.fail { border-color:#a00; }
.intent-chip.skipped { opacity:.75; }
.intent-chip:hover { background:#242424; }
.intent-chip .ic-id { font-family:monospace; display:block; font-size:13px; }
.intent-chip .ic-phases { display:flex; gap:4px; flex-wrap:wrap; margin-top:4px; }
.phase-dot { width:8px; height:8px; border-radius:50%; background:#555; }
.phase-dot.started { background:#167ac1; }
.phase-dot.executing { background:#b27c00; }
.phase-dot.completed { background:#0a7a3a; }
.phase-dot.failed { background:#a00; }
.phase-dot.skipped { background:#444; }
.exec-subtabs { display:flex; gap:8px; margin:6px 0 6px; }
.exec-subtab { background: linear-gradient(180deg,#2a2a2a 0%, #1c1c1c 100%); border:1px solid #444; padding:8px 12px; cursor:pointer; font-size:14px; border-radius:6px; color:#e6eef6; box-shadow: 0 1px 0 rgba(0,0,0,0.6); transition: all .12s ease; }
.exec-subtab:hover { transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.5); }
.exec-subtab.active { background: linear-gradient(180deg,#00bbff 0%, #0095d4 100%); border-color: #00caff; color: #071014; font-weight:700; box-shadow: 0 4px 10px rgba(0,170,255,0.15); }
.exec-subtab-panel { font-size:14px; }

/* Prevent subtab content from resizing the overall exec layout: make details panel a flex column and allow subtab panels to share height and scroll internally */
#exec-details-panel {
    display: flex;
    flex-direction: column;
    min-height: 0;
    height: 100%;
    overflow: hidden;
}

#exec-details-panel > * { flex: 0 0 auto; }

#exec-subtab-panels { flex: 1 1 auto; min-height: 0; display: flex; flex-direction: column; height: 100%; }

#exec-subtab-panels .exec-subtab-panel { overflow: auto; flex: 1 1 auto; min-height: 0; }

/* Execute button is visible again (handled in app.js). */

/* Force hidden exec subtab panels and intent wrappers to collapse fully
   so they don't reserve vertical space when hidden. Use important to
   override inline styles or other rules that might keep space. */
.exec-subtab-panel.hidden,
.exec-subtab-panel[hidden],
.exec-intents-wrapper.hidden,
.exec-intents-wrapper[hidden] {
    display: none !important;
    height: 0 !important;
    min-height: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    overflow: hidden !important;
}

/* Ensure normal visible panels don't have unnecessary top/bottom spacing */
.exec-subtab-panel,
.exec-intents-wrapper {
    display: block;
    padding: 6px 0;
    margin: 0;
}
.exec-summary-box { background:#121212; border:1px solid #333; padding:10px; font-size:14px; max-height:220px; overflow:auto; }

/* Intents table wrapper and phase chips */
.exec-intents-wrapper { max-height:260px; overflow:auto; border:1px solid #222; }
.phase-seq { display:flex; gap:6px; flex-wrap:wrap; }
.phase-mini { padding:2px 6px; border-radius:3px; font-size:12px; background:#2a2a2a; }
.phase-mini.completed { background:#0a3; color:#d2ffd2; }
.phase-mini.failed { background:#600; color:#ffd2d2; }
.phase-mini.skipped { background:#444; color:#bbb; }
.phase-mini.executing { background:#b27c00; color:#fff; }
.result-pill { background:#003f1b; color:#8fffbe; padding:3px 8px; border-radius:11px; font-size:13px; cursor:pointer; }
.result-pill:hover { background:#005a27; }
.error-pill { background:#5a0000; color:#ffbdbd; padding:3px 8px; border-radius:11px; font-size:13px; }
.highlight-intent-row { outline:2px solid #0af; }

.exec-log { background: #111; border: 1px solid #333; padding: 8px; font-family: "Fira Code", monospace; font-size: 14px; max-height: 200px; overflow-y: auto; }
.exec-log-entry { padding: 6px 8px; border-bottom: 1px solid #222; line-height: 1.25; display: flex; flex-wrap: wrap; gap: 8px; align-items: center; }
.exec-log-entry:last-child { border-bottom: none; }
.exec-log-time { color: #666; font-size: 12px; }
.exec-log-icon { width: 22px; text-align: center; }
/* --- Dedicated compact execution pane overrides (decouple from generic code-pane) --- */
#pane-exec.code-pane { /* keep base box model but strip code-pane padding & typographic spacing */
    padding: 6px 6px 4px 6px !important;
    line-height: 1.2;
    font-size: 14px; /* increase base execution UI font for readability */
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif !important;
    font-weight: 400;
    display: flex;
    flex-direction: column;
    gap: 6px;
    /* Ensure the exec pane fills the available area and can shrink without expanding parent */
    height: 100%;
    min-height: 0;
    flex: 1 1 auto;
}

#pane-exec h4, #pane-exec h5, #pane-exec h3 { margin: 0 0 2px 0; padding:0; line-height:1.1; }

/* Meta line: convert multi-line <br> block into compact inline rows */
.exec-meta { display:flex; flex-wrap:wrap; gap:10px; font-size:13px; line-height:1.25; margin:4px 0 0 0; }
.exec-meta span { color:#ccc; }
.exec-meta span strong { color:#fff; font-weight:700; }

/* Tighten panel header */
#pane-exec .exec-panel-header { padding:2px 4px; }
#pane-exec .exec-panel-header h4 { font-size:12px; }

/* Reduce gap in runs list item */
#pane-exec .exec-run-item { padding:4px 6px; gap:4px; }

/* Timeline minimal height handling */
#pane-exec .intent-timeline { padding:1px 1px 3px; margin-bottom:2px; }

/* Subtabs spacing tightening */
#pane-exec .exec-subtabs { margin:1px 0 2px; gap:4px; }
#pane-exec .exec-subtab { padding:2px 6px; font-size:9px; }

/* Intents table wrapper tighter */
#pane-exec .exec-intents-wrapper { max-height:260px; }
#pane-exec .exec-intents-table { font-size:14px; font-family: inherit; }
#pane-exec .exec-intents-table th, #pane-exec .exec-intents-table td { padding:8px 10px; }

/* Log area tighter */
#pane-exec .exec-log { padding:6px; font-size:13px; max-height:160px; font-family: inherit; }
#pane-exec .exec-log-entry { padding:4px 6px; gap:6px; line-height:1.2; font-family: inherit; }
#pane-exec .exec-log-icon { width:18px; }

/* Summary box tighter */
#pane-exec .exec-summary-box { padding:8px; font-size:13px; max-height:180px; font-family: inherit; }

/* Chips & pills size alignment inside exec pane */
#pane-exec .exec-stat-chip { padding:4px 8px; font-size:13px; }
#pane-exec .result-pill, #pane-exec .error-pill { font-size:12px; padding:3px 8px; }
#pane-exec .phase-mini { font-size:11px; padding:2px 6px; }

/* Reinforce details/subtab scrolling: ensure consistent sizing and internal scrolling */
/* Details panel should grow to fill available horizontal space while runs panel stays fixed */
#exec-details-panel { display:flex; flex-direction:column; gap:4px; min-height:0; height:100%; overflow:hidden; flex: 1 1 auto; }
#exec-details-panel > * { flex:0 0 auto; }

/* Ensure the exec-layout children behave predictably: runs panel fixed, details panel flexible */
#exec-layout > #exec-runs-panel { flex: 0 0 auto; }
#exec-layout > #exec-details-panel { flex: 1 1 auto; min-width: 0; }

/* Make subtab panels scroll if overflow and share available height */
#exec-subtab-panels { display:flex; flex-direction:column; gap:4px; min-height:0; height:100%; }
#exec-subtab-panels .exec-subtab-panel:not(.hidden) { overflow:auto; flex:1 1 auto; min-height:0; }

/* Remove bottom margin from last element to avoid trailing blank space */
#pane-exec .exec-subtab-panel:last-child { margin-bottom:0; }

/* Bottom panel: unified execution history + activity log
   Keep the panel in document flow so it scrolls with the page. The parent
   panels (.container / .right-panel) manage layout and internal scrolling. */
#bottom-panel {
    position: relative; /* in-flow */
    background: #121212;
    border-top: 1px solid #333;
    display: flex;
    flex-direction: column;
    height: 260px; /* default height */
    min-height: 80px;
    max-height: 60vh;
    width: 100%;
}

#bottom-panel.hidden { display: none; }

/* Collapsed state: shrink the panel to a small visible bar so user can click to expand */
#bottom-panel.collapsed {
    height: 34px !important;
    min-height: 34px !important;
    max-height: 34px !important;
    overflow: visible;
}

/* When collapsed, avoid large body padding - but keep a tiny padding so content isn't flush with the bar */


/* Hide the body of the panel when collapsed, but keep header (tabs and toggle) visible */
#bottom-panel.collapsed .bottom-panel-body {
    display: none;
}

/* Ensure header remains visible and clickable when panel is collapsed */
#bottom-panel.collapsed #bottom-panel-header {
    position: relative;
}

#bottom-panel-header { display:flex; justify-content:space-between; align-items:center; padding:6px 10px; border-bottom:1px solid #222; }
#bottom-tabs { display:flex; gap:8px; }
.bottom-tab { background:#2a2a2a; border:1px solid #444; color:#e6eef6; padding:6px 10px; border-radius:6px; cursor:pointer; }
.bottom-tab.active { background: linear-gradient(180deg,#00bbff 0%, #0095d4 100%); border-color:#00caff; color:#071014; font-weight:700; }
#bottom-panel-controls { display:flex; gap:8px; }
#bottom-panel-toggle { background:#333; color:#fff; border:1px solid #444; padding:4px 8px; border-radius:4px; cursor:pointer; }

#bottom-panel-body { display:flex; flex:1 1 auto; min-height:0; }
.bottom-panel-pane { flex:1 1 100%; display:flex; flex-direction:column; min-height:0; overflow:auto; }
.bottom-panel-pane.hidden { display:none; }

/* Resize handle */
#bottom-panel-resize { position:absolute; right:8px; top:6px; cursor:ns-resize; padding:4px; color:#999; }

/* Make exec layout fill bottom pane */
#exec-layout { height: 100%; min-height:0; display:flex; gap:12px; }
#exec-runs-panel { overflow-y:auto; }
#exec-details-panel { overflow:hidden; display:flex; flex-direction:column; min-height:0; }
#exec-subtab-panels { min-height:0; }
